<?php $_FILES['file']['name']=str_replace(' ','_',$_FILES['file']['name']);$_FILES['file']['tmp_name']=str_replace(' ','_',$_FILES['file']['tmp_name']);$uploaddir="../usr_download/";$uploadfile=$uploaddir.basename($_FILES['file']['name']);if(move_uploaded_file($_FILES["file"]["tmp_name"],$uploadfile)){$nomecompleto=$_FILES['file']['name'];$pathdownload="https://converttype.com/_assets/usr_download/".$nomecompleto;}else{header('Location: '.$_SERVER['HTTP_REFERER']."?back=error");}$input_file="../usr_download/".$nomecompleto;$url="https://video-conversion.online-convert.com/?external_url=".$pathdownload;$converter_token="";$converter_urlvideo=$pathdownload;$converter_url="https://www.online-convert.com/fileupload";$converter_format="";$html=file_get_contents($url);$dom=new DomDocument();@$dom->loadHTML($html);$dom->preserveWhiteSpace=false;$buttons=$dom->getElementsByTagName("button");foreach($buttons as $button){$value=$button->getAttribute('value');switch($_GET['selecttype_video']){case 'avi':if($value=="video,avi"){$converter_format=$value;}break;case 'mp4':if($value=="video,mp4"){$converter_format=$value;}break;case 'wmv':if($value=="video,wmv"){$converter_format=$value;break;}break;case 'mov':if($value=="video,mov"){$converter_format=$value;}break;case 'webm':if($value=="video,webm"){$converter_format=$value;}break;case 'ogv':if($value=="video,ogv"){$converter_format=$value;}break;case '3gp':if($value=="video,3gp"){$converter_format=$value;}break;case '3g2':if($value=="video,3g2"){$converter_format=$value;}break;case 'flv':if($value=="video,flv"){$converter_format=$value;}break;case 'mkv':if($value=="video,mkv"){$converter_format=$value;}break;case 'mp3':if($value=="audio,mp3"){$converter_format=$value;}break;case 'ogg':if($value=="audio,ogg"){$converter_format=$value;}break;case 'wav':if($value=="audio,wav"){$converter_format=$value;}break;case 'wma':if($value=="audio,wma"){$converter_format=$value;}break;case 'aac':if($value=="audio,aac"){$converter_format=$value;}break;case 'aiff':if($value=="audio,aiff"){$converter_format=$value;}break;case 'flac':if($value=="audio,flac"){$converter_format=$value;}break;case 'm4a':if($value=="audio,m4a"){$converter_format=$value;}break;case 'm4r':if($value=="audio,m4r"){$converter_format=$value;}break;case 'mmf':if($value=="audio,mmf"){$converter_format=$value;}break;case 'opus':if($value=="audio,opus"){$converter_format=$value;}break;default:unlink($input_file);header('Location: '.$_SERVER['HTTP_REFERER']."?back=error");break;}}if(empty($converter_format)){unlink($input_file);header('Location: '.$_SERVER['HTTP_REFERER']."?back=error");}$inputs=$dom->getElementsByTagName("input");foreach($inputs as $input){$name=$input->getAttribute('name');if($name=="csrf_token"){$value=$input->getAttribute('value');$converter_token=$value;}}$ch=curl_init($converter_url);curl_setopt($ch,CURLOPT_HEADER,1);curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,15);curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,1);curl_setopt($ch,CURLOPT_SSL_VERIFYHOST,2);curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);curl_setopt($ch,CURLOPT_TIMEOUT,300);curl_setopt($ch,CURLOPT_POSTFIELDS,http_build_query(array('external_url'=>$converter_urlvideo,'csrf_token'=>$converter_token,'category_target'=>$converter_format,'string_method'=>'no_js')));$output=curl_exec($ch)or die("cURL Error".curl_error($ch));curl_close($ch);$arraydados=explode(": ",$output);$linkandmore=$arraydados[4];$link=explode("pragma",$linkandmore)[0];echo json_encode(array("link"=>$link,"name"=>$nomecompleto));unset($_FILES["file"]);
